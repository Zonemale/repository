<html>
<head>
  <title>springMVC</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600388 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2056"/>
<h1>springMVC</h1>

<div>
<span><div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">一、三层架构&amp;MVC模型</span></font></div><div><span style="font-size: 12pt;">1.三层架构</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;"><b>三层架构中，每一层各司其职，接下来我们就说说每层都负责哪些方面：</b></font></div><div><font style="font-size: 12pt;"><b>表现层：</b></font></div><div><font style="font-size: 12pt;"><b>也就是我们常说的web层。它负责接收客户端请求，向客户端响应结果，通常客户端使用http协议请求</b></font></div><div><font style="font-size: 12pt;"><b>web 层，web 需要接收 http 请求，完成 http 响应。</b></font></div><div><font style="font-size: 12pt;"><b>表现层包括展示层和控制层：控制层负责接收请求，展示层负责结果的展示。</b></font></div><div><font style="font-size: 12pt;"><b>表现层依赖业务层，接收到客户端请求一般会调用业务层进行业务处理，并将处理结果响应给客户端。</b></font></div><div><font style="font-size: 12pt;"><b>表现层的设计一般都使用 MVC 模型。（MVC 是表现层的设计模型，和其他层没有关系）</b></font></div><div><font style="font-size: 12pt;"><b>业务层：</b></font></div><div><font style="font-size: 12pt;"><b>也就是我们常说的 service 层。它负责业务逻辑处理，和我们开发项目的需求息息相关。web 层依赖业</b></font></div><div><font style="font-size: 12pt;"><b>务层，但是业务层不依赖 web 层。</b></font></div><div><font style="font-size: 12pt;"><b>业务层在业务处理时可能会依赖持久层，如果要对数据持久化需要保证事务一致性。（也就是我们说的，</b></font></div><div><font style="font-size: 12pt;"><b>事务应该放到业务层来控制）</b></font></div><div><font style="font-size: 12pt;"><b>持久层：</b></font></div><div><font style="font-size: 12pt;"><b>也就是我们是常说的 dao 层。负责数据持久化，包括数据层即数据库和数据访问层，数据库是对数据进</b></font></div><div><font style="font-size: 12pt;"><b>行持久化的载体，数据访问层是业务层和持久层交互的接口，业务层需要通过数据访问层将数据持久化到数据库</b></font></div><div><font style="font-size: 12pt;"><b>中。通俗的讲，持久层就是和数据库交互，对数据库表进行曾删改查的。</b></font></div></div><div><span style="font-size: 12pt;">2.MVC模型</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b><font style="font-size: 12pt;">Model （模型） ：</font></b></div><div><b><font style="font-size: 12pt;">通常指的就是我们的数据模型。作用一般情况下用于封装数据。</font></b></div><div><b><font style="font-size: 12pt;">View （视图） ：</font></b></div><div><b><font style="font-size: 12pt;">通常指的就是我们的 jsp 或者 html。作用一般就是展示数据的。</font></b></div><div><b><font style="font-size: 12pt;">通常视图是依据模型数据创建的。</font></b></div><div><b><font style="font-size: 12pt;">Controller （控制器） ：</font></b></div><div><b><font style="font-size: 12pt;">是应用程序中处理用户交互的部分。作用一般就是处理程序逻辑的。</font></b></div></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">二、SpringMVC概述</span></font></div><ol><li><div><span style="font-size: 12pt;">SpringMVC 是一种基于 Java 的实现 MVC 设计模型的请求驱动类型的轻量级 Web 框架，属于 Spring</span><span style="font-size: 12pt;">FrameWork 的后续产品，已经融合在 Spring Web Flow 里面</span></div></li><li><div><span style="font-size: 12pt;"><img src="springMVC_files/Image.png" type="image/png" data-filename="Image.png"/></span></div></li><li><div><span style="font-size: 16px;">springMVC和Strus2的优劣分析</span></div></li></ol><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>共同点：</div><div>它们都是表现层框架，都是基于 MVC 模型编写的。</div><div>它们的底层都离不开原始 ServletAPI。</div><div>它们处理请求的机制都是一个核心控制器。</div><div>区别：</div><div>Spring MVC 的入口是 Servlet, 而 Struts2 是 Filter</div><div>Spring MVC 是基于方法设计的，而 Struts2 是基于类，Struts2 每次执行都会创建一个动作类。所</div><div>以 Spring MVC 会稍微比 Struts2 快些。</div><div>Spring MVC 使用更加简洁,同时还支持 JSR303, 处理 ajax 的请求更方便</div><div>(JSR303 是一套 JavaBean 参数校验的标准，它定义了很多常用的校验注解，我们可以直接将这些注</div><div>解加在我们 JavaBean 的属性上面，就可以在需要校验的时候进行校验了。)</div><div>Struts2 的 OGNL 表达式使页面的开发效率相比 Spring MVC 更高些，但执行效率并没有比 JSTL 提</div><div>升，尤其是 struts2 的表单标签，远没有 html 执行效率高。</div></div><div><span style="font-size: 16px;">入门程序流程分析</span></div><div><span style="font-size: 12pt;"><img src="springMVC_files/03.bmp" type="image/bmp" data-filename="03.bmp"/></span></div><div><br/></div><div><span style="font-size: 16px;">springMVC执行流程原理</span></div><div><span style="font-size: 12pt;"><img src="springMVC_files/04.bmp" type="image/bmp" data-filename="04.bmp"/></span></div><div><span style="font-size: 16px;">入门案例中涉及到的组件</span></div><ol><li><div><span style="font-size: 12pt;">DispatcherServlet：</span></div></li><ol><li><div><span style="font-size: 12pt;">前端控制器：</span><span style="font-size: 12pt;">用户请求到达前端控制器，它就相当于 mvc 模式中的 c，dispatcherServlet 是整个流程控制的中心，由</span><span style="font-size: 12pt;">它调用其它组件处理用户的请求，dispatcherServlet 的存在降低了组件之间的耦合性。</span></div></li></ol><li><div><span style="font-size: 12pt;">HandlerMapping ：处理器映射器</span></div></li><ol><li><div><span style="font-size: 12pt;">HandlerMapping 负责根据用户请求找到 Handler 即处理器，SpringMVC 提供了不同的映射器实现不同的</span><span style="font-size: 12pt;">映射方式，例如：配置文件方式，实现接口方式，注解方式等。</span></div></li></ol><li><div><span style="font-size: 12pt;">Handler ：处理器</span></div></li><ol><li><div><span style="font-size: 12pt;">它就是我们开发中要编写的具体业务控制器。由 DispatcherServlet 把用户请求转发到 Handler。由</span><span style="font-size: 12pt;">Handler 对具体的用户请求进行处理。</span></div></li></ol><li><div><span style="font-size: 12pt;">HandlAdapter：处理器适配器</span></div></li><ol><li><div><span style="font-size: 12pt;">通过 HandlerAdapter 对处理器进行执行，这是适配器模式的应用，通过扩展适配器可以对更多类型的处理</span><span style="font-size: 12pt;">器进行执行。</span></div></li></ol><li><div><span style="font-size: 12pt;">View Resolver ：视图解析器</span></div></li><ol><li><div><span style="font-size: 12pt;">View Resolver 负责将处理结果生成 View 视图，View Resolver 首先根据逻辑视图名解析成物理视图名</span><span style="font-size: 12pt;">即具体的页面地址，再生成 View 视图对象，最后对 View 进行渲染将处理结果通过页面展示给用户</span></div></li></ol><li><div><span style="font-size: 12pt;">View ：视图</span></div></li><ol><li><div><span style="font-size: 12pt;">SpringMVC 框架提供了很多的 View 视图类型的支持，包括：jstlView、freemarkerView、pdfView</span><span style="font-size: 12pt;">等。我们最常用的视图就是 jsp</span></div></li></ol><li><div><span style="font-size: 12pt;">&lt;mvc:annotation-driven&gt; 说明</span></div></li><ol><li><div><span style="font-size: 12pt;">在 SpringMVC 的各个组件中，处理器映射器、处理器适配器、视图解析器称为 SpringMVC 的三大组件</span></div></li></ol></ol><div><span style="font-size: 14pt; font-weight: bold;">三、RequestMapping注解</span></div><ol><li><div><span style="font-size: 16px;">概念：</span><span style="font-size: 12pt;">用于建立请求 URL 和处理请求方法之间的对应关系。</span></div></li><li><div><span style="font-size: 12pt;">属性：</span></div></li><ol><li><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">value：用于指定请求的 URL。它和 path 属性的作用是一样的。</span></span></div></li><li><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(255, 0, 0); font-weight: bold;">method：用于指定请求的方式。</span></span></div></li><li><div><span style="font-size: 12pt;">params：用于指定限制请求参数的条件。它支持简单的表达式。要求请求参数的 key 和 value 必须和</span><span style="font-size: 12pt;">配置的一模一样。</span></div></li><li><div><span style="font-size: 12pt;">headers：用于指定限制请求消息头的条件</span></div></li></ol></ol><div><span style="font-size: 14pt; font-weight: bold;">四、请求参数的绑定</span></div><ol><li><div><span style="font-size: 12pt;">绑定机制</span></div></li><ol><li><div><span style="font-size: 12pt;"> 表单提交的数据都是k=v格式的 username=haha&amp;password=123</span></div></li><li><div><span style="font-size: 12pt;"> SpringMVC的参数绑定过程是<span style="font-size: 12pt; color: rgb(235, 0, 115); font-weight: bold;">把表单提交的请求参数，作为控制器中方法的参数进行绑定的（反射实现）</span></span></div></li><li><div><span style="font-size: 12pt;"> 要求：提交表单的name和参数的名称是相同的</span></div></li></ol><li><div><span style="font-size: 12pt;">基本类型参数 ：</span></div></li><ol><li><div><span style="font-size: 12pt;">包括基本类型和 String 类型</span></div></li><li><div><span style="font-size: 16px;">get方法请求乱码原理</span></div></li></ol><li><div><span style="font-size: 12pt;">POJO  类型参数 ：</span></div></li><ol><li><div><span style="font-size: 12pt;">包括实体类，以及关联的实体类</span></div></li></ol><li><div><span style="font-size: 12pt;">数组和集合类型参数 ：</span></div></li><ol><li><div><span style="font-size: 12pt;">包括 List 结构和 Map 结构的集合（包括数组）</span></div></li></ol><li><div><span style="font-size: 12pt;">自定义类型转换器</span></div></li><ol><li><div><span style="font-size: 12pt;">表单提交的任何数据类型全部都是字符串类型，但是后台定义Integer类型，数据也可以封装上，说明</span><span style="font-size: 12pt;">Spring框架内部会默认进行数据类型转换</span></div></li></ol><li><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">在控制器中使用原生的ServletAPI对象</span></span></div></li><ol><li><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(118, 0, 216); font-weight: bold;">只需要在控制器的方法参数定义HttpServletRequest和HttpServletResponse对象</span></span></div></li></ol></ol><div><span style="font-size: 14pt; font-weight: bold;">五、常用注解</span></div><ol><li><div><span style="font-size: 12pt;">RequestParam注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用：把请求中的指定名称的参数传递给控制器中的形参赋值</span></div></li><li><div><span style="font-size: 16px;">属性：</span></div></li><ol><li><div><span style="font-size: 16px;">value：请求参数中的名称</span></div></li><li><div><span style="font-size: 16px;">required：请求参数中是否必须提供此参数，默认值是true，必须提供</span></div></li></ol></ol><li><div><span style="font-size: 12pt;">RequestBody注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用：用于获取请求体的内容（注意：get方法不可以）</span></div></li><li><div><span style="font-size: 16px;">属性：</span></div></li><ol><li><div><span style="font-size: 12pt;">required：是否必须有请求体，默认值是true</span></div></li></ol></ol><li><div><span style="font-size: 12pt;">PathVariable注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用：拥有绑定url中的占位符的。例如：url中有/delete/{id}，{id}就是占位符</span></div></li><li><div><span style="font-size: 16px;">属性</span></div></li><ol><li><div><span style="font-size: 12pt;">value：指定url中的占位符名称</span></div></li></ol><li><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(54, 101, 238);">Restful风格的URL</span></span></div></li><ol><li><div><span style="font-size: 12pt;">请求路径一样，可以根据不同的请求方式去执行后台的不同方法</span></div></li><li><div><span style="font-size: 12pt;"> restful风格的URL优点</span></div></li><ol><li><div><span style="font-size: 12pt;"> 结构清晰</span></div></li><li><div><span style="font-size: 12pt;">符合标准</span></div></li><li><div><span style="font-size: 12pt;">易于理解</span></div></li><li><div><span style="font-size: 12pt;">扩展方便</span></div></li></ol></ol></ol><li><div><span style="font-size: 12pt;">RequestHeader注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用：获取指定请求头的值</span></div></li><li><div><span style="font-size: 16px;">属性：</span></div></li><ol><li><div><span style="font-size: 16px;">value：请求头的名称</span></div></li></ol></ol><li><div><span style="font-size: 12pt;">CookieValue注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用：用于获取指定cookie的名称的值</span></div></li><li><div><span style="font-size: 16px;">属性：</span></div></li><ol><li><div><span style="font-size: 12pt;">value：cookie的名称</span></div></li></ol></ol><li><div><span style="font-size: 12pt;">ModelAttribute注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用</span></div></li><ol><li><div><span style="font-size: 12pt;">出现在方法上：表示当前方法会在控制器方法执行前先执行。</span></div></li><li><div><span style="font-size: 12pt;">出现在参数上：获取指定的数据给参数赋值。</span></div></li></ol><li><div><span style="font-size: 12pt;">应用场景</span></div></li><ol><li><div><span style="font-size: 12pt;">当提交表单数据不是完整的实体数据时，保证没有提交的字段使用数据库原来的数据。</span></div></li></ol></ol><li><div><span style="font-size: 12pt;">SessionAttributes注解</span></div></li><ol><li><div><span style="font-size: 12pt;">作用：用于多次执行控制器方法间的参数共享</span></div></li><li><div><span style="font-size: 12pt;">属性</span></div></li><ol><li><div><span style="font-size: 12pt;">value：指定存入属性的名称</span></div></li></ol><li><div><span style="font-size: 16px;"><span style="font-size: 16px; color: rgb(45, 79, 201); font-weight: bold;">model对象会将数据存储到request域对象当中</span></span></div></li></ol></ol><div><span style="font-size: 16px;">配置/和/*的区别：</span></div><div><span style="font-size: 16px;">    /:不拦截jsp，拦截除了jsp之外所有资源</span></div><div><span style="font-size: 16px;">    /*:拦截所有的资源</span></div><div><span style="font-size: 14pt; font-weight: bold;">六、Model,ModelMap,ModelAndView</span></div><div><span style="font-weight: bold; font-size: 14pt;">七、过滤器和拦截器</span></div><div><span style="font-size: 12pt;">过滤器是 servlet 规范中的一部分，任何 java web 工程都可以使用。</span></div><div><span style="font-size: 12pt;">拦截器是 SpringMVC 框架自己的，只有使用了 SpringMVC 框架的工程才能用。</span></div><div><span style="font-size: 12pt;">过滤器在 url-pattern 中配置了/*之后，可以对所有要访问的资源拦截。</span></div><div><span style="font-size: 12pt;">拦截器它是只会拦截访问的控制器方法，如果访问的是 jsp，html,css,image 或者 js 是不会进行拦</span><span style="font-size: 12pt;">截的。</span></div><div><br/></div><div><span style="font-size: 16px;">重写拦截器的方法：</span></div><div><span style="font-size: 16px;">    return true：放行，执行下一个拦截器，如果没有，执行controller中的方法</span></div><div><span style="font-size: 16px;">    return false：不放行</span></div><div><span style="font-size: 16px;">拦截器接口中的方法：</span></div><div><span style="font-size: 16px;">    <font color="#A600C4">preHandle:controller执行前执行该方法</font></span></div><div><span style="font-size: 16px;"><font color="#A600C4">    postHandle:在controller执行后执行该方法</font></span></div><div><span style="font-size: 16px;"><font color="#A600C4">    afterHandle:在success.jsp页面执行后执行该方法</font></span></div><div><span style="font-size: 16px;"><b><font style="color: rgb(227, 0, 0);">静态资源直接从tomcat的defaultServlet经过，不会经过springmvc的前端控制器</font></b></span></div><div><span style="font-size: 16px;"><b><font style="color: rgb(227, 0, 0);"><br/></font></b></span></div><div><span style="font-size: 12pt; color: rgb(227, 0, 0);"><b><img src="springMVC_files/02.bmp" type="image/bmp" data-filename="02.bmp"/></b></span></div><div><span style="font-size: 16px;">    </span></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div></div><div><br/></div></span>
</div></body></html> 